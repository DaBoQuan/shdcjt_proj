INSERT INTO HtmlLabelIndex values(19598,'折旧年限') 
/
INSERT INTO HtmlLabelInfo VALUES(19598,'折旧年限',7) 
/
INSERT INTO HtmlLabelInfo VALUES(19598,'Depreciation Year',8) 
/

alter table CptCapital add depreyear decimal(18,2)
/
alter table CptCapital add deprerate decimal(18,2)
/

insert into CptCapitalModifyField (field,name)
values (53,'折旧年限')
/
insert into CptCapitalModifyField (field,name)
values (54,'残值率')
/
CREATE OR REPLACE PROCEDURE CptCapital_Insert (
mark_1              varchar2,
name_2              varchar2,
barcode_3           varchar2,
seclevel_6          smallint,
resourceid_1        integer,
sptcount_1          char,
currencyid_10       integer,
capitalcost_11      number,
startprice_12       number,
depreendprice_1     number,
capitalspec_1       varchar2,
capitallevel_1      varchar2,
manufacturer_1      varchar2,
capitaltypeid_13    integer,
capitalgroupid_14   integer,
unitid_15           integer,
capitalnum_1        decimal,
replacecapitalid_17 integer,
version_18          varchar2,
remark_20           varchar2,
capitalimageid_21   integer,
depremethod1_22     integer,
depremethod2_23     integer,
customerid_26       integer,
attribute_27        smallint,
datefield1_30       char,
datefield2_31       char,
datefield3_32       char,
datefield4_33       char,
datefield5_34       char,
numberfield1_35     float,
numberfield2_36     float,
numberfield3_37     float,
numberfield4_38     float,
numberfield5_39     float,
textfield1_40       varchar2,
textfield2_41       varchar2,
textfield3_42       varchar2,
textfield4_43       varchar2,
textfield5_44       varchar2,
tinyintfield1_45    char,
tinyintfield2_46    char,
tinyintfield3_47    char,
tinyintfield4_48    char,
tinyintfield5_49    char,
createrid_50        integer,
createdate_51       char,
createtime_52       char,
lastmoderid_53      integer,
lastmoddate_54      char,
lastmodtime_55      char,
isdata_1            char,
depreyear_57		number,
deprerate_58		number,
flag out integer,
msg out varchar2,
thecursor IN OUT cursor_define.weavercursor) 
as 
thisid_1 integer; 
begin 

insert into CptCapital (
mark,
name,
barcode,
seclevel,
resourceid,
sptcount,
currencyid,
capitalcost,
startprice,
depreendprice,
capitalspec,
capitallevel,
manufacturer,
capitaltypeid,
capitalgroupid,
unitid,
capitalnum,
replacecapitalid,
version,
remark,
capitalimageid,
depremethod1,
depremethod2,
customerid,
attribute,
datefield1,
datefield2,
datefield3,
datefield4,
datefield5,
numberfield1,
numberfield2,
numberfield3,
numberfield4,
numberfield5,
textfield1,
textfield2,
textfield3,
textfield4,
textfield5,
tinyintfield1,
tinyintfield2,
tinyintfield3,
tinyintfield4,
tinyintfield5,
createrid,
createdate,
createtime,
lastmoderid,
lastmoddate,
lastmodtime,
isdata,
depreyear,
deprerate)  
VALUES (
mark_1,
name_2,
barcode_3,
seclevel_6,
resourceid_1,
sptcount_1,
currencyid_10,
capitalcost_11,
startprice_12,
depreendprice_1,
capitalspec_1,
capitallevel_1,
manufacturer_1,
capitaltypeid_13,
capitalgroupid_14,
unitid_15,
capitalnum_1,
replacecapitalid_17,
version_18,
remark_20,
capitalimageid_21,
depremethod1_22,
depremethod2_23,
customerid_26,
attribute_27,
datefield1_30,
datefield2_31,
datefield3_32,
datefield4_33,
datefield5_34,
numberfield1_35,
numberfield2_36,
numberfield3_37,
numberfield4_38,
numberfield5_39,
textfield1_40,
textfield2_41,
textfield3_42,
textfield4_43,
textfield5_44,
tinyintfield1_45,
tinyintfield2_46,
tinyintfield3_47,
tinyintfield4_48,
tinyintfield5_49,
createrid_50,
createdate_51,
createtime_52,
lastmoderid_53,
lastmoddate_54,
lastmodtime_55,
isdata_1,
depreyear_57,
deprerate_58);

select max(id) INTO thisid_1 from CptCapital; 

update CptCapitalAssortment 
set capitalcount = capitalcount+1 
where id in (select capitalgroupid from CptCapital where id = thisid_1); 

open thecursor for select max(id) from CptCapital; 
end;
/

CREATE or REPLACE  PROCEDURE CptCapital_Update 
	(id_1 	            integer,
	mark_2              varchar2,
	name_3 	            varchar2,
	barcode_4 	        varchar2,
	startdate_1		    char,
	enddate_1		    char,
	seclevel_7 	        smallint,
	resourceid_1	    integer,
	sptcount_1 	        char,
	currencyid_11 	    integer,
	capitalcost_12 	    number,
	startprice_13 	    number,
	depreendprice_1     number,
	capitalspec_1	    varchar2,			
	capitallevel_1	    varchar2,			
	manufacturer_1	    varchar2,
	manudate_1		    char,			
	capitaltypeid_14 	integer,
	capitalgroupid_15 	integer,
	unitid_16 	        integer,
	replacecapitalid_18 integer,
	version_19 	        varchar2,
	location_1          varchar2,
	remark_21 	        varchar2,
	capitalimageid_22 	integer,
	depremethod1_23 	integer,
	depremethod2_24 	integer,
	customerid_27 	    integer,
	attribute_28 	    smallint,
	datefield1_31 	    char,
	datefield2_32 	    char,
	datefield3_33 	    char,
	datefield4_34 	    char,
	datefield5_35 	    char,
	numberfield1_36 	float,
	numberfield2_37 	float,
	numberfield3_38 	float,
	numberfield4_39 	float,
	numberfield5_40 	float,
	textfield1_41 	    varchar2,
	textfield2_42 	    varchar2,
	textfield3_43 	    varchar2,
	textfield4_44 	    varchar2,
	textfield5_45 	    varchar2,
	tinyintfield1_46 	char,
	tinyintfield2_47 	char,
	tinyintfield3_48 	char,
	tinyintfield4_49 	char,
	tinyintfield5_50 	char,
	lastmoderid_51 	    integer,
	lastmoddate_52 	    char,
	lastmodtime_53 	    char,
	relatewfid_1		integer,
	alertnum_1          number,
	fnamark_1			varchar2,
	isinner_1			char,
	invoice_1			varchar2,
	StockInDate_1		char,
	depreyear_1	 		number,
	deprerate_1 		number,
	flag out integer ,
	msg out varchar2,
	thecursor IN OUT cursor_define.weavercursor )
AS

tempgroupid integer;
begin

/*更新资产组中的资产卡片数量信息*/
select capitalgroupid INTO tempgroupid from CptCapital where id=id_1;
if tempgroupid<>capitalgroupid_15 then
	update CptCapitalAssortment set capitalcount = capitalcount-1 where id=tempgroupid;
	update CptCapitalAssortment set capitalcount = capitalcount+1 where id=capitalgroupid_15;
end if;

UPDATE CptCapital 
SET  	 
    mark	 = mark_2,
    name	 = name_3,
    barcode	 = barcode_4,
    startdate = startdate_1,
    enddate	 = enddate_1,	
    seclevel	 = seclevel_7,
    resourceid = resourceid_1,
    sptcount	= sptcount_1,	
    currencyid	 = currencyid_11,
    capitalcost	 = capitalcost_12,
    startprice	 = startprice_13,
    depreendprice	= depreendprice_1,
    capitalspec	= capitalspec_1,
    capitallevel	= capitallevel_1,
    manufacturer	= manufacturer_1,
    manudate      = manudate_1,
    capitaltypeid	 = capitaltypeid_14,
    capitalgroupid	 = capitalgroupid_15,
    unitid	 = unitid_16,
    replacecapitalid = replacecapitalid_18,
    version	 = version_19,
    location	  = location_1,
    remark	 = remark_21,
    capitalimageid	 = capitalimageid_22,
    depremethod1	 = depremethod1_23,
    depremethod2	 = depremethod2_24,
    customerid	 = customerid_27,
    attribute	 = attribute_28,
    datefield1	 = datefield1_31,
    datefield2	 = datefield2_32,
    datefield3	 = datefield3_33,
    datefield4	 = datefield4_34,
    datefield5	 = datefield5_35,
    numberfield1	 = numberfield1_36,
    numberfield2	 = numberfield2_37,
    numberfield3	 = numberfield3_38,
    numberfield4	 = numberfield4_39,
    numberfield5	 = numberfield5_40,
    textfield1	 = textfield1_41,
    textfield2	 = textfield2_42,
    textfield3	 = textfield3_43,
    textfield4	 = textfield4_44,
    textfield5	 = textfield5_45,
    tinyintfield1	 = tinyintfield1_46,
    tinyintfield2	 = tinyintfield2_47,
    tinyintfield3	 = tinyintfield3_48,
    tinyintfield4	 = tinyintfield4_49,
    tinyintfield5	 = tinyintfield5_50,
    lastmoderid	 = lastmoderid_51,
    lastmoddate	 = lastmoddate_52,
    lastmodtime	 = lastmodtime_53,
    relatewfid	= relatewfid_1,
    alertnum	 = alertnum_1,
    fnamark	= fnamark_1,
    isinner	= isinner_1,
	invoice	= invoice_1,
	StockInDate	= StockInDate_1,
	depreyear	= depreyear_1,
	deprerate	= deprerate_1
	 
WHERE 
	( id	 = id_1);
end;
/
CREATE OR REPLACE PROCEDURE CptCapital_Duplicate (
capitalid_1 	integer,
customerid_1	integer,
price_1			number,
capitalspec_1	varchar2,
location_1		varchar2,
invoice_1		varchar2,
StockInDate_1	char,
flag out integer  ,
msg out varchar2,
thecursor IN OUT cursor_define.weavercursor ) AS 
maxid integer; 
begin 
    INSERT INTO CptCapital (
    mark,
    name,
    barcode,
    startdate,
    enddate,
    seclevel,
    departmentid,
    costcenterid,
    resourceid,
    crmid,
    sptcount,
    currencyid ,
    capitalcost,
    startprice,
    depreendprice,
    capitalspec,
    capitallevel,
    manufacturer,
    manudate,
    capitaltypeid,
    capitalgroupid,
    unitid,
    capitalnum,
    currentnum,
    replacecapitalid,
    version,
    itemid,
    remark,
    capitalimageid,
    depremethod1,
    depremethod2,
    deprestartdate,
    depreenddate,
    customerid,
    attribute,
    stateid,
    location,
    usedhours,
    datefield1,
    datefield2,
    datefield3,
    datefield4,
    datefield5,
    numberfield1,
    numberfield2,
    numberfield3,
    numberfield4,
    numberfield5,
    textfield1,
    textfield2,
    textfield3,
    textfield4,
    textfield5,
    tinyintfield1,
    tinyintfield2,
    tinyintfield3,
    tinyintfield4,
    tinyintfield5,
    createrid,
    createdate,
    createtime,
    lastmoderid,
    lastmoddate,
    lastmodtime,
    isdata,
    datatype,
    relatewfid,
	invoice,
	StockInDate,
	depreyear,
	deprerate)  
    
    select 
    mark,
    name,
    barcode,
    startdate,
    enddate	,
    seclevel,
    departmentid,
    costcenterid,
    resourceid,
    crmid,
    sptcount,
    currencyid ,
    capitalcost,
    price_1,
    depreendprice,
    capitalspec_1,
    capitallevel,
    manufacturer,
    manudate,
    capitaltypeid,
    capitalgroupid,
    unitid,
    capitalnum,
    currentnum,
    replacecapitalid,
    version,
    itemid,
    remark,
    capitalimageid,
    depremethod1,
    depremethod2,
    deprestartdate,
    depreenddate,
    customerid_1,
    attribute,
    stateid,
    location_1,
    usedhours,
    datefield1,
    datefield2,
    datefield3,
    datefield4,
    datefield5,
    numberfield1,
    numberfield2,
    numberfield3,
    numberfield4,
    numberfield5,
    textfield1,
    textfield2,
    textfield3,
    textfield4,
    textfield5,
    tinyintfield1,
    tinyintfield2,
    tinyintfield3,
    tinyintfield4,
    tinyintfield5,
    createrid,
    createdate,
    createtime,
    lastmoderid,
    lastmoddate,
    lastmodtime,
    isdata,
    datatype,
    relatewfid,
	invoice_1,
	StockInDate_1,
	depreyear,
	deprerate    	
    from CptCapital 
    where id = capitalid_1; 
    
    select  max(id) INTO maxid  from CptCapital; 
    update CptCapital set capitalnum = 0 where id = maxid; 
    open thecursor for 
        select maxid from dual; 
end;
/
