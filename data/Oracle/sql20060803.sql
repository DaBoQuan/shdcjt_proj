alter table CptCapital add StockInDate char(10)
/
CREATE OR REPLACE PROCEDURE CptCapital_Duplicate (
capitalid_1 	integer,
customerid_1	integer,
price_1			number,
capitalspec_1	varchar2,
location_1		varchar2,
invoice_1		varchar2,
StockInDate_1	char,
flag out integer  ,
msg out varchar2,
thecursor IN OUT cursor_define.weavercursor ) AS 
maxid integer; 
begin 
    INSERT INTO CptCapital (
    mark,
    name,
    barcode,
    startdate,
    enddate,
    seclevel,
    departmentid,
    costcenterid,
    resourceid,
    crmid,
    sptcount,
    currencyid ,
    capitalcost,
    startprice,
    depreendprice,
    capitalspec,
    capitallevel,
    manufacturer,
    manudate,
    capitaltypeid,
    capitalgroupid,
    unitid,
    capitalnum,
    currentnum,
    replacecapitalid,
    version,
    itemid,
    remark,
    capitalimageid,
    depremethod1,
    depremethod2,
    deprestartdate,
    depreenddate,
    customerid,
    attribute,
    stateid,
    location,
    usedhours,
    datefield1,
    datefield2,
    datefield3,
    datefield4,
    datefield5,
    numberfield1,
    numberfield2,
    numberfield3,
    numberfield4,
    numberfield5,
    textfield1,
    textfield2,
    textfield3,
    textfield4,
    textfield5,
    tinyintfield1,
    tinyintfield2,
    tinyintfield3,
    tinyintfield4,
    tinyintfield5,
    createrid,
    createdate,
    createtime,
    lastmoderid,
    lastmoddate,
    lastmodtime,
    isdata,
    datatype,
    relatewfid,
	invoice,
	StockInDate) 
    
    select 
    mark,
    name,
    barcode,
    startdate,
    enddate	,
    seclevel,
    departmentid,
    costcenterid,
    resourceid,
    crmid,
    sptcount,
    currencyid ,
    capitalcost,
    price_1,
    depreendprice,
    capitalspec_1,
    capitallevel,
    manufacturer,
    manudate,
    capitaltypeid,
    capitalgroupid,
    unitid,
    capitalnum,
    currentnum,
    replacecapitalid,
    version,
    itemid,
    remark,
    capitalimageid,
    depremethod1,
    depremethod2,
    deprestartdate,
    depreenddate,
    customerid_1,
    attribute,
    stateid,
    location_1,
    usedhours,
    datefield1,
    datefield2,
    datefield3,
    datefield4,
    datefield5,
    numberfield1,
    numberfield2,
    numberfield3,
    numberfield4,
    numberfield5,
    textfield1,
    textfield2,
    textfield3,
    textfield4,
    textfield5,
    tinyintfield1,
    tinyintfield2,
    tinyintfield3,
    tinyintfield4,
    tinyintfield5,
    createrid,
    createdate,
    createtime,
    lastmoderid,
    lastmoddate,
    lastmodtime,
    isdata,
    datatype,
    relatewfid,
	invoice_1,
	StockInDate_1 
    from CptCapital 
    where id = capitalid_1; 
    
    select  max(id) INTO maxid  from CptCapital; 
    update CptCapital set capitalnum = 0 where id = maxid; 
    open thecursor for 
        select maxid from dual; 
end;
/

CREATE OR REPLACE PROCEDURE CptCapital_UpdatePrice (
id_1 	        integer,
price 	        number,
capitalspec_1	varchar2,
customerid_1	integer,
location_1		varchar2,
invoice_1		varchar2,
StockInDate_1   char,
flag    out     integer ,
msg     out     varchar2,
thecursor IN OUT cursor_define.weavercursor) AS 

begin 
    UPDATE CptCapital 
    SET  startprice=price,
		 capitalspec=capitalspec_1,
		 customerid=customerid_1,
		 location=location_1,
		 invoice=invoice_1,
		 StockInDate=StockInDate_1  	 
    WHERE ( id	= id_1) ; 
end;
/
